<!DOCTYPE html>
<html>
<head>
    <title>üÄÑ Taiwanese Mahjong - WHITE BACKGROUND</title>
    <style>
        body { 
            font-family: Arial; 
            background: white; 
            color: #333; 
            text-align: center; 
            padding: 20px;
        }
        .table { 
            background: linear-gradient(#F5F5F5, #E8E8E8); 
            border-radius: 20px; 
            padding: 30px; 
            max-width: 1000px; 
            margin: 0 auto; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .hand { 
            background: rgba(255,255,255,0.9); 
            border: 3px solid #DDD;
            border-radius: 15px; 
            padding: 20px; 
            margin: 15px; 
            display: inline-block; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        /* MAHJONG TILE GRAPHICS */
        .tile { 
            display: inline-block; 
            width: 50px; 
            height: 70px; 
            margin: 4px; 
            border-radius: 10px; 
            position: relative;
            cursor: pointer; 
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15),
                        inset 0 1px 0 rgba(255,255,255,0.8),
                        inset 0 -2px 4px rgba(0,0,0,0.1);
            font-weight: bold; 
            font-size: 16px;
            line-height: 70px;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.3);
            border: 1px solid rgba(0,0,0,0.1);
        }
        
        /* CIRCLE TILES - ORANGE DOTS */
        .circles { 
            background: linear-gradient(145deg, #FF6B35 0%, #FF8C42 50%, #FF9500 100%);
            color: #FFF;
        }
        
        /* BAMBOO TILES - GREEN STICKS */
        .bamboos { 
            background: repeating-linear-gradient(
                90deg, 
                #228B22 0px, 
                #228B22 4px, 
                #32CD32 4px, 
                #32CD32 8px
            ), linear-gradient(145deg, #90EE90, #228B22);
            color: #FFF;
        }
        
        /* CHARACTER TILES - BROWN ‰∏á */
        .characters { 
            background: linear-gradient(145deg, #8B4513 0%, #A0522D 50%, #D2691E 100%);
            color: #FFF;
        }
        
        /* HONOR TILES - WINDS & DRAGONS */
        .honors { 
            background: linear-gradient(145deg, #4169E1 0%, #1E90FF 100%);
            color: #FFF;
            font-size: 20px;
        }
        .honors.e::before { content: 'Êù±'; }
        .honors.s::before { content: 'Âçó'; }
        .honors.w::before { content: 'Ë•ø'; }
        .honors.n::before { content: 'Âåó'; }
        .honors.rd::before { content: '‰∏≠'; }
        .honors.gd::before { content: 'Áôº'; }
        .honors.wd::before { content: 'ÁôΩ'; }
        
        /* BONUS TILES - FLOWERS */
        .bonus { 
            background: linear-gradient(145deg, #FF69B4 0%, #FF1493 70%, #C71585 100%);
            color: #FFF;
            font-size: 14px;
        }
        
        /* INTERACTION EFFECTS */
        .tile:hover { 
            transform: translateY(-6px) scale(1.08) !important; 
            box-shadow: 0 8px 20px rgba(0,0,0,0.2) !important;
        }
        .tile.selected { 
            background: linear-gradient(145deg, #FFD700, #FFA500) !important;
            box-shadow: 0 0 30px rgba(255,215,0,0.8) !important;
            transform: scale(1.15) translateY(-10px) !important;
            z-index: 10;
        }
        .discard { 
            background: linear-gradient(145deg, #FF4444, #CC0000) !important;
            transform: rotate(8deg) translateX(8px) scale(0.95);
            filter: brightness(1.2);
        }
        
        /* WHITE BACKGROUND UI */
        button { 
            padding: 15px 30px; 
            font-size: 18px; 
            margin: 10px; 
            border: none; 
            border-radius: 25px; 
            cursor: pointer; 
            background: linear-gradient(#4CAF50, #45a049); 
            color: white; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            font-weight: bold;
        }
        button:hover { transform: translateY(-3px); box-shadow: 0 7px 20px rgba(0,0,0,0.3); }
        
        #log { 
            height: 280px; 
            overflow-y: scroll; 
            background: rgba(248,248,248,0.95); 
            border-radius: 15px; 
            padding: 20px; 
            margin: 20px auto; 
            max-width: 1000px; 
            text-align: left;
            border: 1px solid #DDD;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            color: #333;
        }
        .current { border-color: #FFD700 !important; box-shadow: 0 0 20px rgba(255,215,0,0.6); }
        #status { font-size: 24px; margin: 20px; font-weight: bold; color: #333; }
        h1 { color: #333; text-shadow: none; font-size: 2.5em; }
        h3 { color: #555; }
    </style>
</head>
<body>
    <div class="table">
        <h1>üÄÑ Taiwanese Mahjong</h1>
        <div id="status">Click NEW GAME to start</div>
        
        <div id="hands"></div>
        
        <button onclick="newGame()">üÄÑ New Game</button>
        <button onclick="autoPlay()">‚ö° Auto Turn</button>
        <button onclick="showAll()">üëÅ Show All Hands</button>
        
        <div id="log"></div>
    </div>

    <script>
        const game = {
            players: [], wall: [], currentPlayer: 0, selectedTile: null, gameOver: false
        };

        const SUITS = ['c', 'b', 'ch'];
        const HONORS = ['e','s','w','n','rd','gd','wd'];
        const BONUS = ['f1','f2','f3','f4','s1','s2','s3','s4'];

        function createDeck() {
            let deck = [];
            for(let suit of SUITS) {
                for(let n=1; n<=9; n++) {
                    for(let i=0; i<4; i++) deck.push(`${n}${suit}`);
                }
            }
            for(let h of HONORS) {
                for(let i=0; i<4; i++) deck.push(h);
            }
            deck.push(...BONUS);
            return deck;
        }

        class Player {
            constructor(name, isRobot) {
                this.name = name;
                this.isRobot = isRobot;
                this.hand = [];
                this.bonus = [];
                this.discards = [];
            }
            sortHand() {
                this.hand.sort((a,b) => a.localeCompare(b));
            }
        }

        function newGame() {
            let deck = createDeck();
            for(let i = deck.length - 1; i > 0; i--) {
                let j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
            
            game.wall = deck.slice(0, 120);
            game.players = [
                new Player('You', false),
                new Player('Robot 1', true),
                new Player('Robot 2', true),
                new Player('Robot 3', true)
            ];
            
            game.players.forEach(player => {
                player.hand = [];
                player.bonus = [];
                player.discards = [];
                for(let i = 0; i < 16; i++) {
                    if(game.wall.length) {
                        let tile = game.wall.shift();
                        if(BONUS.includes(tile)) {
                            player.bonus.push(tile);
                            if(game.wall.length) tile = game.wall.shift();
                        }
                        player.hand.push(tile);
                    }
                }
                player.sortHand();
            });
            
            game.currentPlayer = 0;
            game.selectedTile = null;
            game.gameOver = false;
            updateDisplay();
            document.getElementById('status').innerHTML = 'Your turn! Click tiles twice to discard';
            log('üéÆ New game started - WHITE background!');
        }

        function updateDisplay(showAll = false) {
            let html = '';
            game.players.forEach((player, i) => {
                let style = (i === 0 || showAll) ? '' : 'display:none;';
                let isCurrent = i === game.currentPlayer;
                
                let handHtml = player.hand.map(tile => 
                    `<div class="tile ${getTileClass(tile)} ${game.selectedTile === tile && i === 0 ? 'selected' : ''}" 
                       data-num="${getTileNumber(tile)}" 
                       onclick="selectTile('${tile}', ${i})" title="${tile}">
                    </div>`
                ).join('');
                
                html += `
                    <div class="hand ${isCurrent ? 'current' : ''}" style="${style}">
                        <h3>${player.name} (${player.hand.length} tiles, ${player.bonus.length} üå∏)</h3>
                        <div>${handHtml}</div>
                        <div style="font-size:12px;opacity:0.8;color:#666;">
                            Discards: ${player.discards.slice(-4).map(getTileText).join(' ')}
                        </div>
                    </div>
                `;
            });
            document.getElementById('hands').innerHTML = html;
        }

        function getTileClass(tile) {
            if(BONUS.includes(tile)) return 'bonus';
            if(HONORS.includes(tile)) return `honors ${tile}`;
            let suit = tile.slice(-1);
            return suit === 'c' ? 'circles' : suit === 'b' ? 'bamboos' : 'characters';
        }

        function getTileNumber(tile) {
            return tile.slice(0, -1);
        }

        function getTileText(tile) {
            if(BONUS.includes(tile)) return 'üå∏';
            if(HONORS.includes(tile)) return tile.toUpperCase();
            return tile.slice(0, -1);
        }

        function selectTile(tile, playerIdx) {
            if(game.gameOver || playerIdx !== 0 || game.currentPlayer !== 0) return;
            
            if(game.selectedTile === tile) {
                game.players[0].hand = game.players[0].hand.filter(t => t !== tile);
                game.players[0].discards.push(tile);
                game.selectedTile = null;
                log(`‚úÖ You discarded ${getTileText(tile)}`);
                setTimeout(nextTurn, 600);
            } else {
                game.selectedTile = tile;
                updateDisplay();
                log(`Selected: ${getTileText(tile)} (click again)`);
            }
        }

        function robotTurn() {
            let player = game.players[game.currentPlayer];
            let discardIdx = Math.floor(Math.random() * player.hand.length);
            let discard = player.hand.splice(discardIdx, 1)[0];
            player.discards.push(discard);
            log(`ü§ñ ${player.name} discards ${getTileText(discard)}`);
        }

        function nextTurn() {
            game.currentPlayer = (game.currentPlayer + 1) % 4;
            updateDisplay();
            
            if(game.players[game.currentPlayer].isRobot) {
                setTimeout(() => {
                    robotTurn();
                    setTimeout(nextTurn, 800);
                }, 400);
            } else {
                document.getElementById('status').innerHTML = 'Your turn! Click tiles twice';
                log('üéØ Your turn!');
            }
        }

        function autoPlay() {
            if(game.currentPlayer === 0 && !game.selectedTile) {
                let tile = game.players[0].hand[Math.floor(Math.random() * game.players[0].hand.length)];
                selectTile(tile, 0);
            }
        }

        function showAll() {
            updateDisplay(true);
            log('üëÅ All hands visible');
        }

        function log(msg) {
            document.getElementById('log').innerHTML += `<div style="color:#555;">${msg}</div>`;
            document.getElementById('log').scrollTop = 9999;
        }

        newGame();
    </script>
</body>
</html>
