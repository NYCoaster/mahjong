<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taiwanese Mahjong - You vs Robots</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Roboto', Arial, sans-serif; 
            background: linear-gradient(135deg, #2c1810 0%, #1a0f0b 100%);
            min-height: 100vh; display: flex; flex-direction: column;
        }
        
        #table {
            flex: 1; max-width: 1400px; margin: 20px auto; padding: 30px;
            background: radial-gradient(ellipse at center, #228B22 0%, #006400 70%);
            border: 40px solid #8B4513; border-radius: 30px;
            box-shadow: 0 30px 80px rgba(0,0,0,0.8);
        }
        
        #game-area {
            display: grid; 
            grid-template-areas: 
                "north     north     north"
                "west      center    east "
                "south     south     south";
            gap: 20px; height: 700px; padding: 20px;
        }
        
        .player.north { grid-area: north; }
        .player.east  { grid-area: east; }
        .player.south { grid-area: south; }
        .player.west  { grid-area: west; }
        #center      { grid-area: center; }
        
        .player { 
            background: rgba(139,69,19,0.9); border: 4px solid #D4AF37; 
            border-radius: 20px; padding: 20px; text-align: center;
            box-shadow: 0 15px 40px rgba(0,0,0,0.6);
        }
        
        /* YOU - BOTTOM (big visible hand) */
        .player.south { 
            background: linear-gradient(145deg, rgba(212,175,55,0.9), rgba(139,69,19,0.9));
            border-color: #FFD700; min-height: 250px;
        }
        .player.south .name { color: #FFD700; font-size: 28px; font-weight: bold; }
        .player.south .hand { justify-content: center; gap: 8px; }
        
        /* ROBOTS - HIDDEN HANDS (back sides only) */
        .player.north .name, .player.east .name, .player.west .name { 
            color: #FF6B6B; font-weight: bold; font-size: 22px; margin-bottom: 10px;
        }
        
        .hand { 
            display: flex; gap: 4px; justify-content: center; flex-wrap: wrap; 
            min-height: 100px; margin: 10px 0; padding: 15px;
            background: rgba(255,255,255,0.1); border-radius: 12px;
        }
        
        /* YOUR TILES - VISIBLE */
        .tile {
            width: 42px; height: 58px; 
            background: linear-gradient(145deg, #F5DEB3, #D2B48C);
            border: 3px solid #8B4513; border-radius: 6px; 
            display: flex; align-items: center; justify-content: center; 
            font-size: 26px; cursor: pointer; position: relative;
            box-shadow: 0 6px 16px rgba(0,0,0,0.4); transition: all 0.3s;
        }
        
        /* ROBOT TILES - HIDDEN BACKS */
        .tile.back {
            background: linear-gradient(145deg, #654321, #8B4513) !important;
            color: transparent !important;
            font-size: 20px !important;
        }
        .tile.back::after {
            content: 'ğŸ€„'; opacity: 0.4; font-size: 18px;
        }
        
        .tile:hover:not(.back) { 
            transform: translateY(-4px) scale(1.05); 
            box-shadow: 0 10px 25px rgba(0,0,0,0.6); 
        }
        .tile.selected { 
            border-color: #FFD700 !important; 
            box-shadow: 0 0 25px #FFD700 !important; 
            transform: scale(1.15) !important; 
            z-index: 10;
        }
        .tile.discard { 
            background: linear-gradient(145deg, #E0E0E0, #B0B0B0); 
            transform: rotate(10deg); margin: 2px; 
        }
        
        #center { 
            background: rgba(0,100,0,0.8); border: 4px solid #D4AF37; 
            border-radius: 20px; display: flex; flex-direction: column; 
            align-items: center; padding: 25px; color: white; 
            font-size: 20px; text-shadow: 2px 2px 4px black;
        }
        #discard-pile { 
            display: flex; flex-wrap: wrap; gap: 12px; 
            justify-content: center; max-width: 450px; margin: 20px 0;
        }
        
        #controls { 
            background: rgba(0,0,0,0.9); padding: 25px; text-align: center; 
            color: white; border-top: 5px solid #D4AF37;
        }
        button { 
            padding: 15px 30px; margin: 8px; border: 3px solid #D4AF37; 
            background: linear-gradient(145deg, #8B4513, #A0522D); color: white; 
            border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 16px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.5);
        }
        button:hover:not(:disabled) { 
            background: linear-gradient(145deg, #A0522D, #D2691E); 
            transform: translateY(-3px); 
        }
        button:disabled { opacity: 0.5; cursor: not-allowed; }
        
        @media (max-width: 768px) {
            #game-area { 
                grid-template-areas: 
                    "north" 
                    "center" 
                    "south" 
                    "west east"; 
                gap: 10px; 
            }
            .tile { width: 36px; height: 50px; font-size: 22px; }
            .tile.back::after { font-size: 16px; }
        }
    </style>
</head>
<body>
    <div id="table">
        <div id="game-area">
            <!-- NORTH Robot - HIDDEN HAND -->
            <div class="player north">
                <div class="name">ğŸ¤– NORTH ROBOT</div>
                <div class="hand" id="hand-north"></div>
            </div>
            
            <!-- EAST Robot - HIDDEN HAND -->
            <div class="player east">
                <div class="name">ğŸ¤– EAST ROBOT</div>
                <div class="hand" id="hand-east"></div>
            </div>
            
            <!-- YOU (BOTTOM) - VISIBLE HAND -->
            <div class="player south">
                <div class="name">ğŸ§‘ YOU (South Dealer)</div>
                <div class="hand" id="hand-south"></div>
            </div>
            
            <!-- WEST Robot - HIDDEN HAND -->
            <div class="player west">
                <div class="name">ğŸ¤– WEST ROBOT</div>
                <div class="hand" id="hand-west"></div>
            </div>
            
            <!-- CENTER -->
            <div id="center">
                <div id="status" style="font-size: 24px; margin-bottom: 20px;">Dealing tiles...</div>
                <div id="discard-pile"></div>
                <div style="margin-top: 20px;">
                    <span>Round: <span id="round">1</span></span> | 
                    <span style="margin-left: 20px;">Score: <span id="score">0</span></span> | 
                    <span style="margin-left: 20px;">Wall: <span id="tilesLeft">144</span></span>
                </div>
            </div>
        </div>
    </div>
    
    <div id="controls">
        <button onclick="discardSelected()" id="discardBtn">ğŸ—‘ï¸ Discard Selected</button>
        <button onclick="sortHand()">ğŸ”¤ Sort Hand</button>
        <button onclick="newRound()">ğŸ”„ New Round</button>
    </div>

    <script>
        const suits = {
            wan: ['ğŸ€‡','ğŸ€ˆ','ğŸ€‰','ğŸ€Š','ğŸ€‹','ğŸ€Œ','ğŸ€','ğŸ€','ğŸ€'],
            tong: ['ğŸ€™','ğŸ€š','ğŸ€›','ğŸ€œ','ğŸ€','ğŸ€','ğŸ€Ÿ','ğŸ€ ','ğŸ€¡'],
            tiao: ['ğŸ€','ğŸ€‘','ğŸ€’','ğŸ€“','ğŸ€”','ğŸ€•','ğŸ€–','ğŸ€—','ğŸ€˜']
        };
        
        let game = {
            wall: [], players: {south: [], east: [], north: [], west: []},
            discardPile: [], currentPlayer: 'south', selectedTile: null,
            round: 1, score: 0, tilesLeft: 144
        };
        
        function createTileDeck() {
            let deck = [];
            for (let suit in suits) {
                for (let tile of suits[suit]) {
                    for (let i = 0; i < 4; i++) deck.push(tile);
                }
            }
            return shuffle(deck);
        }
        
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
        
        function deal() {
            game.wall = createTileDeck();
            game.players = {south: [], east: [], north: [], west: []};
            game.discardPile = [];
            game.tilesLeft = 144;
            game.selectedTile = null;
            game.round++;
            
            // Deal 16 tiles each (Taiwanese Mahjong)
            ['south', 'east', 'north', 'west'].forEach(player => {
                for (let i = 0; i < 16; i++) {
                    game.players[player].push(game.wall.pop());
                }
            });
            game.tilesLeft -= 64;
            
            renderAll();
            updateStatus('ğŸ§‘ Your turn! Select a tile to discard.');
            document.getElementById('discardBtn').disabled = false;
        }
        
        function renderAll() {
            renderHands();
            renderDiscardPile();
            updateUI();
        }
        
        function renderHands() {
            ['south', 'east', 'north', 'west'].forEach(player => {
                const handEl = document.getElementById(`hand-${player}`);
                handEl.innerHTML = '';
                
                game.players[player].forEach((tile, i) => {
                    const tileEl = document.createElement('div');
                    if (player === 'south') {
                        // YOUR HAND - VISIBLE
                        tileEl.className = 'tile';
                        tileEl.textContent = tile;
                        tileEl.onclick = () => selectTile(i);
                        if (game.selectedTile === i) tileEl.classList.add('selected');
                    } else {
                        // ROBOT HANDS - HIDDEN BACKS
                        tileEl.className = 'tile back';
                    }
                    handEl.appendChild(tileEl);
                });
            });
        }
        
        function renderDiscardPile() {
            const pileEl = document.getElementById('discard-pile');
            pileEl.innerHTML = '';
            game.discardPile.slice(-12).reverse().forEach(tile => {
                const tileEl = document.createElement('div');
                tileEl.className = 'tile discard';
                tileEl.textContent = tile;
                pileEl.appendChild(tileEl);
            });
        }
        
        function selectTile(index) {
            if (game.currentPlayer !== 'south') return;
            game.selectedTile = game.selectedTile === index ? null : index;
            renderHands();
        }
        
        function discardSelected() {
            if (game.selectedTile === null) {
                alert('Please select a tile first!');
                return;
            }
            
            const tile = game.players.south.splice(game.selectedTile, 1)[0];
            game.discardPile.push(tile);
            game.selectedTile = null;
            game.tilesLeft--;
            
            renderAll();
            updateStatus('ğŸ¤– Robots thinking...');
            document.getElementById('discardBtn').disabled = true;
            
            // Robot round
            setTimeout(() => {
                robotRound();
            }, 1200);
        }
        
        function robotRound() {
            const robotOrder = ['east', 'north', 'west'];
            let robotIndex = 0;
            
            function robotTurn() {
                if (robotIndex >= robotOrder.length || game.tilesLeft <= 0) {
                    updateStatus('ğŸ§‘ Your turn!');
                    document.getElementById('discardBtn').disabled = false;
                    return;
                }
                
                const player = robotOrder[robotIndex];
                // Robot draws and discards randomly
                if (game.wall.length > 0) {
                    const drawn = game.wall.pop();
                    game.players[player].push(drawn);
                }
                
                if (game.players[player].length > 0) {
                    const discardIndex = Math.floor(Math.random() * game.players[player].length);
                    const tile = game.players[player].splice(discardIndex, 1)[0];
                    game.discardPile.push(tile);
                    game.tilesLeft--;
                }
                
                renderAll();
                updateStatus(`ğŸ¤– ${player.toUpperCase()} discards...`);
                
                robotIndex++;
                setTimeout(robotTurn, 800);
            }
            
            robotTurn();
        }
        
        function sortHand() {
            if (game.currentPlayer !== 'south') return;
            game.players.south.sort();
            renderHands();
        }
        
        function updateStatus(msg) {
            document.getElementById('status').textContent = msg;
        }
        
        function updateUI() {
            document.getElementById('round').textContent = game.round;
            document.getElementById('score').textContent = game.score;
            document.getElementById('tilesLeft').textContent = game.tilesLeft;
        }
        
        function newRound() {
            deal();
        }
        
        // Initialize game
        document.getElementById('discardBtn').onclick = discardSelected;
        deal();
    </script>
</body>
</html>

