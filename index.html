<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mahjong â€¢ Windows Game</title>
    <style>
        :root {
            --bg-primary: #201F1E;
            --bg-secondary: #252423;
            --accent-primary: #0078D4;
            --accent-secondary: #106EBE;
            --surface: rgba(255,255,255,0.1);
            --surface-alt: rgba(255,255,255,0.05);
            --text-primary: #FFFFFF;
            --text-secondary: #E1DFDD;
            --border: rgba(255,255,255,0.2);
            --success: #107C10;
            --warning: #CA5010;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', -apple-system, sans-serif;
            background: var(--bg-primary); color: var(--text-primary);
            min-height: 100vh; overflow-x: hidden;
        }
        
        /* Fluent 2 Header */
        #header {
            background: var(--bg-secondary); backdrop-filter: blur(20px);
            padding: 24px; border-bottom: 1px solid var(--border);
            display: flex; justify-content: space-between; align-items: center;
        }
        h1 { 
            font-weight: 600; font-size: 28px; letter-spacing: -0.5px;
            background: linear-gradient(135deg, var(--accent-primary), #40C4FF);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        #coins { 
            background: var(--surface); padding: 12px 20px; border-radius: 20px;
            font-weight: 600; font-size: 16px; min-width: 120px; text-align: center;
        }
        
        #main {
            max-width: 1200px; margin: 0 auto; padding: 32px 24px;
            display: grid; grid-template-rows: auto 1fr auto; min-height: calc(100vh - 120px);
        }
        
        /* Fluent Table */
        #table {
            background: var(--surface); border-radius: 24px; padding: 32px;
            backdrop-filter: blur(40px); border: 1px solid var(--border);
            display: grid; grid-template-areas: 
                "top    top    top"
                "left   center right"
                "bot    bot    bot";
            gap: 24px; height: 100%; box-shadow: 0 32px 64px rgba(0,0,0,0.4);
        }
        
        .player.top    { grid-area: top; }
        .player.right  { grid-area: right; }
        .player.bot    { grid-area: bot; }
        .player.left   { grid-area: left; }
        #center        { grid-area: center; }
        
        .player {
            background: var(--surface-alt); border-radius: 16px; padding: 24px;
            backdrop-filter: blur(20px); border: 1px solid var(--border);
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .player:hover { transform: translateY(-2px); box-shadow: 0 16px 32px rgba(0,0,0,0.3); }
        
        .player.bot { 
            background: linear-gradient(145deg, rgba(0,120,212,0.15), var(--surface-alt));
            border-color: var(--accent-primary); min-height: 220px;
        }
        
        .name { 
            font-weight: 600; font-size: 18px; margin-bottom: 16px;
            padding-bottom: 8px; border-bottom: 1px solid var(--border);
        }
        .bot .name { color: var(--accent-primary); }
        .robot .name { color: #FF8C00; }
        
        .hand {
            display: flex; flex-wrap: wrap; justify-content: center; gap: 6px;
            min-height: 80px; padding: 12px 0;
        }
        
        .tile {
            width: 40px; height: 56px; background: linear-gradient(145deg, #FAF9F8, #EDEBE9);
            border: 1px solid #A19F9D; border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
            font-size: 24px; cursor: pointer; position: relative;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .tile.back {
            background: linear-gradient(145deg, #605E5C, #484644) !important;
            color: transparent !important; border-color: #484644;
        }
        .tile.back::after { 
            content: 'ğŸ€„'; opacity: 0.3; font-size: 18px; 
        }
        .tile:hover:not(.back) { 
            transform: translateY(-2px) scale(1.05); 
            box-shadow: 0 8px 24px rgba(0,0,0,0.25);
        }
        .tile.selected { 
            border-color: var(--accent-primary) !important; 
            background: linear-gradient(145deg, #40C4FF, #0078D4);
            box-shadow: 0 0 0 2px var(--accent-primary), 0 8px 24px rgba(0,120,212,0.4);
            transform: scale(1.08);
        }
        .tile.discard { 
            background: linear-gradient(145deg, #F3F2F1, #EDEBE9); 
            transform: rotate(3deg) translateY(2px);
        }
        
        #center {
            background: rgba(32,31,30,0.8); border-radius: 16px; padding: 24px;
            backdrop-filter: blur(20px); border: 1px solid var(--border);
        }
        #status { 
            font-size: 20px; font-weight: 600; margin-bottom: 20px; 
            padding: 12px 20px; background: var(--surface); border-radius: 12px;
        }
        #discard-pile { 
            display: flex; flex-wrap: wrap; gap: 8px; justify-content: center;
            padding: 16px; background: var(--surface-alt); border-radius: 12px;
        }
        
        #controls {
            display: flex; gap: 12px; justify-content: center; padding: 24px;
            background: var(--bg-secondary); border-top: 1px solid var(--border);
            border-radius: 0 0 24px 24px;
        }
        button {
            padding: 14px 28px; border: none; background: var(--accent-primary);
            color: white; border-radius: 12px; cursor: pointer; font-weight: 600;
            font-size: 15px; font-family: inherit; min-width: 140px;
            box-shadow: 0 4px 12px rgba(0,120,212,0.3);
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
        }
        button:hover:not(:disabled) { 
            background: var(--accent-secondary); 
            transform: translateY(-1px); box-shadow: 0 8px 20px rgba(0,120,212,0.4);
        }
        button:disabled { 
            background: #484644; cursor: not-allowed; opacity: 0.6;
            transform: none; box-shadow: none;
        }
        
        /* Fluent Shop */
        #shop {
            position: fixed; top: 24px; right: 24px; background: var(--bg-secondary);
            border: 1px solid var(--border); border-radius: 16px; padding: 24px;
            max-width: 320px; backdrop-filter: blur(20px); box-shadow: 0 16px 40px rgba(0,0,0,0.3);
        }
        #shop h3 { 
            font-weight: 600; font-size: 18px; margin-bottom: 20px; 
            color: var(--text-primary); padding-bottom: 12px; border-bottom: 1px solid var(--border);
        }
        .shop-item { 
            display: flex; justify-content: space-between; align-items: center;
            padding: 16px; margin: 8px 0; background: var(--surface); border-radius: 12px;
            transition: background 0.2s;
        }
        .shop-item:hover { background: rgba(255,255,255,0.15); }
        .shop-item button { 
            padding: 10px 20px; font-size: 14px; min-width: auto; 
            background: var(--success); box-shadow: 0 2px 8px rgba(16,124,16,0.3);
        }
        .shop-item button:hover { background: #148514; }
        
        @media (max-width: 768px) {
            #shop { position: static; margin: 0 -16px 20px; border-radius: 0; }
            #controls { flex-wrap: wrap; gap: 8px; }
            .tile { width: 36px; height: 50px; font-size: 20px; }
        }
    </style>
</head>
<body>
    <!-- Fluent Shop -->
    <div id="shop">
        <h3>ğŸ›’ Mahjong Store</h3>
        <div class="shop-item">
            <div>
                <div style="font-weight: 600; margin-bottom: 4px;">Classic Tiles</div>
                <div style="font-size: 14px; color: var(--text-secondary);">Traditional bamboo design</div>
            </div>
            <button onclick="buyItem(1)">50 coins</button>
        </div>
        <div class="shop-item">
            <div>
                <div style="font-weight: 600; margin-bottom: 4px;">Premium Tiles</div>
                <div style="font-size: 14px; color: var(--text-secondary);">Gold-trimmed luxury</div>
            </div>
            <button onclick="buyItem(2)">120 coins</button>
        </div>
        <div class="shop-item">
            <div>
                <div style="font-weight: 600; margin-bottom: 4px;">Pro AI</div>
                <div style="font-size: 14px; color: var(--text-secondary);">Smart robot opponents</div>
            </div>
            <button onclick="buyItem(3)">80 coins</button>
        </div>
    </div>
    
    <!-- Game Header -->
    <div id="header">
        <h1>ğŸ€„ Mahjong</h1>
        <div id="coins">ğŸ’° 150 coins</div>
    </div>
    
    <!-- Main Game -->
    <div id="main">
        <div id="table">
            <div class="player top robot">
                <div class="name">NORTH</div>
                <div class="hand" id="hand-north"></div>
            </div>
            
            <div class="player right robot">
                <div class="name">EAST</div>
                <div class="hand" id="hand-east"></div>
            </div>
            
            <div class="player bot">
                <div class="name">YOU</div>
                <div class="hand" id="hand-south"></div>
            </div>
            
            <div class="player left robot">
                <div class="name">WEST</div>
                <div class="hand" id="hand-west"></div>
            </div>
            
            <div id="center">
                <div id="status" style="background: rgba(0,120,212,0.2);">Round 1 â€¢ Your turn</div>
                <div id="discard-pile"></div>
                <div style="margin-top: 16px; font-size: 14px; color: var(--text-secondary);">
                    Tiles left: <span id="tilesLeft">144</span>
                </div>
            </div>
        </div>
    </div>
    
    <div id="controls">
        <button onclick="discardSelected()" id="discardBtn" disabled>Discard Tile</button>
        <button onclick="sortHand()">Sort Hand</button>
        <button onclick="newRound()">New Round</button>
    </div>

    <script>
        const suits = {
            wan: ['ğŸ€‡','ğŸ€ˆ','ğŸ€‰','ğŸ€Š','ğŸ€‹','ğŸ€Œ','ğŸ€','ğŸ€','ğŸ€'],
            tong: ['ğŸ€™','ğŸ€š','ğŸ€›','ğŸ€œ','ğŸ€','ğŸ€','ğŸ€Ÿ','ğŸ€ ','ğŸ€¡'],
            tiao: ['ğŸ€','ğŸ€‘','ğŸ€’','ğŸ€“','ğŸ€”','ğŸ€•','ğŸ€–','ğŸ€—','ğŸ€˜']
        };
        
        let game = {
            wall: [], players: {south: [], east: [], north: [], west: []},
            discardPile: [], currentPlayer: 'south', selectedTile: null,
            round: 1, coins: 150, tilesLeft: 144
        };
        
        function createTileDeck() {
            let deck = [];
            for (let suit in suits) {
                for (let tile of suits[suit]) {
                    for (let i = 0; i < 4; i++) deck.push(tile);
                }
            }
            return shuffle(deck);
        }
        
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
        
        function deal() {
            game.wall = createTileDeck();
            game.players = {south: [], east: [], north: [], west: []};
            game.discardPile = [];
            game.tilesLeft = 144;
            game.selectedTile = null;
            
            ['south', 'east', 'north', 'west'].forEach(player => {
                for (let i = 0; i < 16; i++) {
                    game.players[player].push(game.wall.pop());
                }
            });
            game.tilesLeft -= 64;
            
            renderAll();
            updateStatus('Round 1 â€¢ Your turn');
            document.getElementById('discardBtn').disabled = false;
            updateCoins();
        }
        
        function renderAll() {
            renderHands();
            renderDiscardPile();
            updateUI();
        }
        
        function renderHands() {
            ['south', 'east', 'north', 'west'].forEach(player => {
                const handEl = document.getElementById(`hand-${player}`);
                handEl.innerHTML = '';
                game.players[player].forEach((tile, i) => {
                    const tileEl = document.createElement('div');
                    if (player === 'south') {
                        tileEl.className = 'tile';
                        tileEl.textContent = tile;
                        tileEl.onclick = () => selectTile(i);
                        if (game.selectedTile === i) tileEl.classList.add('selected');
                    } else {
                        tileEl.className = 'tile back';
                    }
                    handEl.appendChild(tileEl);
                });
            });
        }
        
        function renderDiscardPile() {
            const pileEl = document.getElementById('discard-pile');
            pileEl.innerHTML = '';
            game.discardPile.slice(-10).reverse().forEach(tile => {
                const tileEl = document.createElement('div');
                tileEl.className = 'tile discard';
                tileEl.textContent = tile;
                pileEl.appendChild(tileEl);
            });
        }
        
        function selectTile(index) {
            game.selectedTile = game.selectedTile === index ? null : index;
            renderHands();
        }
        
        function discardSelected() {
            if (game.selectedTile === null) return alert('Select a tile first!');
            
            const tile = game.players.south.splice(game.selectedTile, 1)[0];
            game.discardPile.push(tile);
            game.selectedTile = null;
            game.tilesLeft--;
            
            renderAll();
            updateStatus('Robots thinking...');
            document.getElementById('discardBtn').disabled = true;
            
            setTimeout(robotRound, 800);
        }
        
        function robotRound() {
            const robots = ['east', 'north', 'west'];
            let i = 0;
            function nextRobot() {
                if (i >= robots.length) {
                    updateStatus(`Round ${game.round} â€¢ Your turn`);
                    document.getElementById('discardBtn').disabled = false;
                    return;
                }
                const player = robots[i++];
                if (game.wall.length > 0) game.players[player].push(game.wall.pop());
                if (game.players[player].length > 0) {
                    const idx = Math.floor(Math.random() * game.players[player].length);
                    game.discardPile.push(game.players[player].splice(idx, 1)[0]);
                }
                game.tilesLeft--;
                renderAll();
                setTimeout(() => nextRobot(), 500);
            }
            nextRobot();
        }
        
        function sortHand() {
            game.players.south.sort();
            renderHands();
        }
        
        function newRound() {
            game.round = 1;
            game.coins += 15;
            deal();
        }
        
        function updateStatus(msg) {
            document.getElementById('status').textContent = msg;
        }
        
        function updateUI() {
            document.getElementById('tilesLeft').textContent = game.tilesLeft;
        }
        
        function updateCoins() {
            document.getElementById('coins').textContent = `ğŸ’° ${game.coins} coins`;
        }
        
        function buyItem(id) {
            const prices = [50, 120, 80];
            if (game.coins >= prices[id-1]) {
                game.coins -= prices[id-1];
                updateCoins();
                alert(`Purchased item ${id}! Feature coming soon.`);
            } else {
                alert('Insufficient coins!');
            }
        }
        
        // Initialize
        document.getElementById('discardBtn').onclick = discardSelected;
        deal();
    </script>
</body>
</html>
