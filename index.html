### Page 1 ###
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Taiwanese Mahjong - 2 Player </title>
<style>
:root {
--table-green: #1a4a33; --tile-ivory: #fffffa; --tile-back: #006633;
--tile-shadow: rgba(0,0,0,0.3);
}
body {
background-color: var(--table-green); background-image:
radial-gradient(circle, #2e8b57 0%, #1a4a33 100%);
font-family: "Microsoft JhengHei", "Heiti TC", sans-serif; color: white;
margin: 0; display: flex; justify-content: center; height: 100vh;
overflow: hidden;
}
.game-container {
display: flex; flex-direction: column; justify-content: space-between;
align-items: center; width: 95%; max-width: 1100px; padding: 15px; height:
98vh; position: relative;
}
.info-panel { text-align: center; background: rgba(0,0,0,0.4); padding:
10px 30px; border-radius: 50px; border: 1px solid rgba(255,255,255,0.1);
box-shadow: 0 4px 15px rgba(0,0,0,0.5); }
h1 { margin: 0; font-size: 1.2rem; color: #ffd700; text-transform:
uppercase; letter-spacing: 2px; }
#status { font-weight: 300; color: #ddd; margin: 5px 0; }
button { padding: 5px 15px; cursor: pointer; background:
linear-gradient(#eee, #ccc); border: 1px solid #999; border-radius: 3px;
font-weight: bold; transition: all 0.2s; }
button:hover { background: #fff; transform: scale(1.05); }
.tile {
 position: relative; width: 42px; height: 58px; background:
var(--tile-ivory); border-radius: 4px;
 display: flex; justify-content: center; align-items: center;
 font-size: 28px; font-weight: bold;

### Page 2 ###
 cursor: pointer; user-select: none; border: 1px solid #ddd;
border-bottom: 5px solid #bbb; border-right: 3px solid #ccc; box-shadow:
4px 4px 8px var(--tile-shadow); transition: transform 0.1s, margin 0.2s;
}
.opponent-hand .tile {
 background: var(--tile-back); background-image: linear-gradient(135deg,
#007744 25%, #005522 100%); border: 1px solid #004411; border-bottom: 5px
solid #003311; border-right: 3px solid #004411;
 color: transparent !important;
}
.tile[data-suit="wan"] { color: #cc0000; } .tile[data-suit="tong"] {
color: #1a4fa0; } .tile[data-suit="tiao"] { color: #1a8033; }
.tile[data-suit="word"] { color: #333; }
.tile[data-val="red"] { color: #ff0000; } .tile[data-val="green"] { color:
#00aa00; }
.player-hand .tile:hover { transform: translateY(-12px); z-index: 10; }
.drawn-tile { margin-left: 15px !important; border: 2px solid gold
!important; }
.hand { display: flex; justify-content: center; align-items: flex-end;
gap: 2px; padding: 15px; width: 100%; }
.table-center { flex-grow: 1; width: 100%; background: rgba(0,0,0,0.1);
border-radius: 100px / 20px; box-shadow: inset 0 0 50px rgba(0,0,0,0.3);
display: flex; flex-direction: column; justify-content: center;
align-items: center; padding: 20px; }
.discard-pile { color: initial; display: grid; grid-template-columns:
repeat(10, 1fr); gap: 5px; max-width: 500px; }
.discard-pile .tile { width: 30px; height: 42px; font-size: 20px;
border-bottom-width: 3px; border-right-width: 2px; cursor: default; }
/* Exposed sets are not used in this simplified version, but keeping the
styles here */
.exposed-sets { display: flex; gap: 10px; margin-bottom: 10px; }
.exposed-sets .tile { cursor: default; }
</style>
</head>
<body>
<div class="game-container">
<div class="info-panel">
 <h1>Taiwanese Mahjong (Simple Flow)</h1>
 <div id="status">Initializing...</div>
 <button onclick="initGame()">New Game</button>

### Page 3 ###
</div>
<!-- Exposed sets removed from simple flow -->
<div class="hand opponent-hand" id="opponent-hand"></div>
<div class="table-center">
 <div class="discard-pile" id="discard-pile"></div>
</div>
<div class="hand player-hand" id="player-hand"></div>
<!-- Exposed sets removed from simple flow -->
<!-- Call buttons removed for strict turn flow -->
</div>
<script>
const SUITS = ['wan', 'tong', 'tiao'];
const WORDS = ['east', 'south', 'west', 'north', 'red', 'green',
'white'];
const HAND_SIZE = 16;
let deck = [], playerHand = [], opponentHand = [], discardPile = [];
let isPlayerTurn = true;
let opponentTurnTimeout = null;
function initGame() {
 if (opponentTurnTimeout) clearTimeout(opponentTurnTimeout);
 deck = [];
 SUITS.forEach(s => { for(let i=1; i<=9; i++) for(let c=0; c<4; c++)
deck.push({s, v:i}); });
 WORDS.forEach(v => { for(let c=0; c<4; c++) deck.push({s:'word', v});
});
 for(let i = deck.length - 1; i > 0; i--) {
 const j = Math.floor(Math.random() * (i + 1));
 [deck[i], deck[j]] = [deck[j], deck[i]];
 }
 playerHand = deck.splice(0, HAND_SIZE); opponentHand = deck.splice(0,
HAND_SIZE);
 discardPile = []; sortHand(playerHand); drawTile('player');
 render();
}
// Draw tile now initiates the next turn

### Page 4 ###
function drawTile(who) {
 if (deck.length === 0) return updateStatus("Draw Game!");
 const tile = deck.pop();
 if (who === 'player') {
 playerHand.push(tile); isPlayerTurn = true; updateStatus("YOUR TURN:
Discard a tile");
 } else {
 opponentHand.push(tile); updateStatus("Opponent's turn...");
 opponentTurnTimeout = setTimeout(aiDiscard, 1000);
 }
 render();
}
// Player discard leads directly to AI turn
function playerDiscard(idx) {
 if (!isPlayerTurn || playerHand.length % 3 !== 2) return;
 const tile = playerHand.splice(idx, 1)[0]; // FIX: Get the single tile
object [0]
 discardPile.push(tile);
 isPlayerTurn = false; sortHand(playerHand); render();
 // After player discards, immediately initiate AI turn
 updateStatus("Your turn ended. Opponent's turn starting...");
 drawTile('opponent');
}
// AI discard leads directly back to Player turn
function aiDiscard() {
 const idx = Math.floor(Math.random() * opponentHand.length);
 const tile = opponentHand.splice(idx, 1)[0]; // FIX: Get the single
tile object [0]
 discardPile.push(tile);
 render();
 // After AI discards, immediately initiate player turn
 updateStatus("Opponent's turn ended.");
 drawTile('player');
}
function sortHand(hand) { hand.sort((a,b) => (a.s +
a.v).localeCompare(b.s + b.v)); }
function getDisplay(t) {

### Page 5 ###
 // FIX: Added a check for undefined tile objects just in case
 if (!t) return '';
 if(t.s === 'wan') return t.v + 'ðŸ€‡'; if(t.s === 'tong') return t.v +
'ðŸ€ '; if(t.s === 'tiao') return t.v + 'ðŸ€’';
 return {'east':'æ±','south':'å—','west':'è¥¿','north':'åŒ—','red':'ä¸­
','green':'ç™¼','white':'ç™½'}[t.v];
}
function render() {
 document.getElementById('player-hand').innerHTML = '';
document.getElementById('opponent-hand').innerHTML = '';
 document.getElementById('discard-pile').innerHTML = '';
 playerHand.forEach((t, i) => { const el = document.createElement('div');
el.className = 'tile'; if (i === playerHand.length - 1 && isPlayerTurn)
el.className += ' drawn-tile'; el.dataset.suit = t.s; el.dataset.val =
t.v; el.innerText = getDisplay(t); el.onclick = () => playerDiscard(i);
document.getElementById('player-hand').appendChild(el); });
 opponentHand.forEach(() => { const el = document.createElement('div');
el.className = 'tile';
document.getElementById('opponent-hand').appendChild(el); });
 discardPile.forEach(t => { const el = document.createElement('div');
el.className = 'tile'; el.dataset.suit = t.s; el.dataset.val = t.v;
el.innerText = getDisplay(t);
document.getElementById('discard-pile').appendChild(el); });
}
function updateStatus(msg) { document.getElementById('status').innerText
= msg; }
initGame();
</script>
</body>
</html>
